{"openapi":"3.0.0","info":{"title":"Emotion Diary API","version":"1.0.0","description":"API для системы дневника эмоций и отслеживания настроения","contact":{"name":"API Support"}},"servers":[{"url":"http://localhost:8099/api","description":"Локальный сервер разработки"}],"tags":[{"name":"Auth","description":"Эндпоинты для аутентификации и регистрации"},{"name":"Checkins","description":"Эндпоинты для записи настроения"},{"name":"Diary","description":"Эндпоинты для работы с дневником"},{"name":"Pet","description":"Эндпоинты для взаимодействия с виртуальным питомцем"},{"name":"Insights","description":"Эндпоинты для получения аналитики и инсайтов (Premium)"},{"name":"Prompts","description":"Эндпоинты для работы с промптами для размышлений"},{"name":"Subscriptions","description":"Эндпоинты для управления подписками"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}},"paths":{"/auth/register":{"post":{"summary":"Регистрация нового пользователя","tags":["Auth"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","username","password"],"properties":{"email":{"type":"string","format":"email","description":"Email пользователя","example":"user@example.com"},"username":{"type":"string","description":"Имя пользователя","example":"user123"},"password":{"type":"string","description":"Пароль пользователя (минимум 6 символов)","example":"password123"}}}}}},"responses":{"201":{"description":"Успешная регистрация","content":{"application/json":{"schema":{"type":"object","properties":{"ok":{"type":"boolean","example":true},"token":{"type":"string","description":"JWT access token"},"refreshToken":{"type":"string","description":"JWT refresh token"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"username":{"type":"string"},"subscription_tier":{"type":"string"}}}}}}}},"400":{"description":"Неправильные данные"},"409":{"description":"Пользователь уже существует"}}}},"/auth/login":{"post":{"summary":"Авторизация пользователя","tags":["Auth"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","description":"Email пользователя","example":"user@example.com"},"password":{"type":"string","description":"Пароль пользователя","example":"password123"}}}}}},"responses":{"200":{"description":"Успешная авторизация","content":{"application/json":{"schema":{"type":"object","properties":{"ok":{"type":"boolean","example":true},"token":{"type":"string"},"refreshToken":{"type":"string"},"user":{"type":"object"}}}}}},"401":{"description":"Неверные учетные данные"}}}},"/auth/refresh":{"post":{"summary":"Обновление JWT токена","tags":["Auth"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["refreshToken"],"properties":{"refreshToken":{"type":"string","description":"Refresh token"}}}}}},"responses":{"200":{"description":"Токен обновлен"},"401":{"description":"Неверный refresh token"}}}},"/auth/logout":{"post":{"summary":"Выход из системы","tags":["Auth"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Успешный выход"}}}},"/checkins":{"post":{"summary":"Создать запись о настроении","tags":["Checkins"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["emotion_id","intensity"],"properties":{"emotion_id":{"type":"integer","description":"ID эмоции (1-6)","example":1},"intensity":{"type":"integer","minimum":1,"maximum":10,"description":"Интенсивность эмоции (1-10)","example":7},"reflection_text":{"type":"string","description":"Опциональный текст размышления (50-500 символов)","example":"Сегодня был хороший день"}}}}}},"responses":{"201":{"description":"Запись создана успешно"},"400":{"description":"Неверные данные"}}},"get":{"summary":"Получить записи о настроении пользователя","tags":["Checkins"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"Номер страницы"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Количество записей на странице"}],"responses":{"200":{"description":"Список записей"}}}},"/checkins/daily/{date}":{"get":{"summary":"Получить записи за конкретную дату","tags":["Checkins"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"date","required":true,"schema":{"type":"string","format":"date"},"description":"Дата в формате YYYY-MM-DD"}],"responses":{"200":{"description":"Список записей за дату"}}}},"/checkins/stats":{"get":{"summary":"Получить статистику по эмоциям (Premium)","tags":["Checkins"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"days","schema":{"type":"integer","default":7},"description":"Количество дней для анализа"}],"responses":{"200":{"description":"Статистика по эмоциям"},"403":{"description":"Требуется Premium подписка"}}}},"/diary":{"get":{"summary":"Получить записи дневника","tags":["Diary"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1}},{"in":"query","name":"limit","schema":{"type":"integer","default":20}},{"in":"query","name":"tags","schema":{"type":"string"}}],"responses":{"200":{"description":"Список записей"}}},"post":{"summary":"Создать запись в дневнике","tags":["Diary"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["content"],"properties":{"title":{"type":"string","description":"Заголовок записи","example":"День первый"},"content":{"type":"string","description":"Содержание записи","example":"Сегодня был замечательный день..."},"tag_ids":{"type":"array","items":{"type":"integer"},"description":"Массив ID тегов","example":[1,2,3]},"source_checkin_ids":{"type":"array","items":{"type":"string"},"description":"Массив ID checkins, которые сгенерировали эту запись"}}}}}},"responses":{"201":{"description":"Запись создана успешно"}}}},"/diary/entries/{id}":{"put":{"summary":"Обновить запись дневника","tags":["Diary"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string"},"content":{"type":"string"},"tag_ids":{"type":"array","items":{"type":"integer"}}}}}}},"responses":{"200":{"description":"Запись обновлена"},"404":{"description":"Запись не найдена"}}},"delete":{"summary":"Удалить запись дневника","tags":["Diary"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Запись удалена"},"404":{"description":"Запись не найдена"}}}},"/diary/monthly":{"get":{"summary":"Получить данные для месячного календаря (heat map)","tags":["Diary"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"year","schema":{"type":"integer"}},{"in":"query","name":"month","schema":{"type":"integer","minimum":1,"maximum":12}}],"responses":{"200":{"description":"Данные для календаря"}}}},"/insights/weekly":{"get":{"summary":"Получить недельную сводку эмоций (Premium)","tags":["Insights"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Недельная сводка"},"403":{"description":"Требуется Premium подписка"}}}},"/insights/triggers":{"get":{"summary":"Получить анализ триггеров эмоций (Premium)","tags":["Insights"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Анализ триггеров"},"403":{"description":"Требуется Premium подписка"}}}},"/insights/recommendations":{"get":{"summary":"Получить персональные рекомендации (Premium)","tags":["Insights"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Рекомендации"},"403":{"description":"Требуется Premium подписка"}}}},"/pet":{"get":{"summary":"Получить состояние питомца","tags":["Pet"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Состояние питомца"}}}},"/pet/feed":{"post":{"summary":"Покормить питомца","tags":["Pet"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Питомец накормлен"}}}},"/pet/pet":{"post":{"summary":"Погладить питомца","tags":["Pet"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Питомец поглажен"}}}},"/pet/talk":{"post":{"summary":"Поговорить с питомцем","tags":["Pet"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["message"],"properties":{"message":{"type":"string","description":"Сообщение для питомца","example":"Привет, как дела?"}}}}}},"responses":{"200":{"description":"Ответ питомца"}}}},"/pet/name":{"put":{"summary":"Переименовать питомца","tags":["Pet"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name"],"properties":{"name":{"type":"string","description":"Новое имя питомца","example":"Барсик"}}}}}},"responses":{"200":{"description":"Имя обновлено"}}}},"/pet/customize":{"post":{"summary":"Изменить внешний вид питомца (Premium)","tags":["Pet"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["cosmetic_skin"],"properties":{"cosmetic_skin":{"type":"string","description":"Название скина","example":"rainbow"}}}}}},"responses":{"200":{"description":"Внешний вид обновлен"},"403":{"description":"Требуется Premium подписка"}}}},"/prompts/daily":{"get":{"summary":"Получить ежедневный промпт для размышления","tags":["Prompts"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Ежедневный промпт"}}}},"/prompts/{id}/response":{"post":{"summary":"Отправить ответ на промпт","tags":["Prompts"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"integer"},"description":"ID промпта"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["response_text"],"properties":{"response_text":{"type":"string","description":"Текст ответа","example":"Сегодня меня вдохновила встреча с друзьями..."}}}}}},"responses":{"201":{"description":"Ответ сохранен"},"400":{"description":"Неверные данные"}}}},"/prompts/responses":{"get":{"summary":"Получить ответы пользователя на промпты","tags":["Prompts"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1}},{"in":"query","name":"limit","schema":{"type":"integer","default":20}}],"responses":{"200":{"description":"Список ответов"}}}},"/subscriptions/create":{"post":{"summary":"Создать подписку (Stripe)","tags":["Subscriptions"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["tier","payment_method_id"],"properties":{"tier":{"type":"string","enum":["premium","premium_annual"],"description":"Тип подписки","example":"premium"},"payment_method_id":{"type":"string","description":"ID метода оплаты Stripe","example":"pm_1234567890"}}}}}},"responses":{"201":{"description":"Подписка создана"},"400":{"description":"Неверные данные"}}}},"/subscriptions/status":{"get":{"summary":"Получить статус текущей подписки","tags":["Subscriptions"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Статус подписки"}}}},"/subscriptions/cancel":{"post":{"summary":"Отменить подписку","tags":["Subscriptions"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Подписка отменена"}}}},"/subscriptions/webhook":{"post":{"summary":"Webhook для обработки событий Stripe","tags":["Subscriptions"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object"}}}},"responses":{"200":{"description":"Webhook обработан"}}}}}}